(function(a) {
  var c = {showCaptions:!0, imageSelector:"img", captionSelector:".caption", displayContainer:"#displayImage", imageDisplayClass:"displayImg", captionDisplayClass:"imgcaption", fadeOutDuration:500, fadeInDuration:800, startIndex:0}, f = [], d = 0, g = "", e = {init:function(b) {
    b && (a.extend(c, b), b.startIndex && (d = b.startIndex));
    return this.each(function() {
      f = [];
      a(this).find("li").each(function() {
        f[f.length] = {img:a(this).find(c.imageSelector).attr("src"), caption:a(this).find(c.captionSelector).text()}
      });
      g = a(this).attr("id");
      a("#" + g).css("display", "none");
      e.updateImage();
      a("#" + g).trigger("ready")
    })
  }, updateImage:function() {
    var b = '<img src="' + f[d].img + '" class="' + c.imageDisplayClass + '" id="currentDisplayImg"/>';
    a(c.displayContainer).html(b);
    a("#currentDisplayImg").css({opacity:0}).load(e.onImgLoad);
    !0 == c.showCaptions && (b = '<div class="' + c.captionDisplayClass + '">' + f[d].caption + "</div>", a(c.displayContainer).append(b), a(".imgcaption").css("opacity", 0))
  }, onImgLoad:function() {
    a("#currentDisplayImg").unbind("load", e.onImgLoad);
    a("#currentDisplayImg").animate({opacity:1}, c.fadeInDuration, "linear");
    !0 == c.showCaptions && a(".imgcaption").animate({opacity:1}, c.fadeInDuration, "linear");
    a("#" + g).trigger("updateImage")
  }, fadeOut:function() {
    a("#currentDisplayImg").animate({opacity:0}, c.fadeOutDuration, "linear", e.updateImage)
  }, nextImage:function() {
    d < f.length - 1 ? d++ : d = 0;
    e.fadeOut()
  }, prevImage:function() {
    d = 0 < d ? d - 1 : f.length - 1;
    e.fadeOut()
  }, showImage:function(a) {
    d = a;
    e.fadeOut()
  }, getCurrentIndex:function() {
    return d
  }};
  a.fn.imageviewer = function(b) {
    if(e[b]) {
      return e[b].apply(this, Array.prototype.slice.call(arguments, 1))
    }
    if("object" === typeof b || !b) {
      return e.init.apply(this, arguments)
    }
    a.error("Method " + b + " does not exist on jQuery.imageviewer")
  }
})(jQuery);